<template>
  <h1 v-if="tasks.length === 0" class="text-center uppercase">Задач пока нет</h1>
  <template v-else>
    <h3 class="title mb-2rem text-center uppercase">Всего активных задач {{activeTasksCount}}</h3>
    <section class="cards">
          <div class="card mb-1rem" v-for="task in tasks" :key="task.id">
          <div class="flex space-between mb-1rem">
           <h2 class="uppercase"> {{task.title}}</h2>
            <AppStatus :type='task.status'/>
          </div >
          <p class='mb-1rem'>
            <strong>Дэдлайн </strong>
            <small>
              {{new Date(task.date).toLocaleDateString()}}
            </small>
          </p>
         <div class="flex space-between">
            <button class="btn-basic uppercase" @click="open(task.id)">Посмотреть задачу</button>
          <div class="icon-svg" @click="deleteTask(task.id)">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 6.66667C11.9999 5.95942 12.2809 5.28115 12.781 4.78105C13.2811 4.28095 13.9593 4 14.6666 4H17.3333C18.0405 4 18.7188 4.28095 19.2189 4.78105C19.719 5.28115 19.9999 5.95942 19.9999 6.66667V8H25.3333C25.6869 8 26.026 8.14048 26.2761 8.39052C26.5261 8.64057 26.6666 8.97971 26.6666 9.33333C26.6666 9.68696 26.5261 10.0261 26.2761 10.2761C26.026 10.5262 25.6869 10.6667 25.3333 10.6667H23.9999V24C23.9999 25.0609 23.5785 26.0783 22.8283 26.8284C22.0782 27.5786 21.0608 28 19.9999 28H11.9999C10.9391 28 9.92164 27.5786 9.17149 26.8284C8.42135 26.0783 7.99992 25.0609 7.99992 24V10.6667H6.66659C6.31296 10.6667 5.97383 10.5262 5.72378 10.2761C5.47373 10.0261 5.33325 9.68696 5.33325 9.33333C5.33325 8.97971 5.47373 8.64057 5.72378 8.39052C5.97383 8.14048 6.31296 8 6.66659 8H11.9999V6.66667ZM13.3333 10.6667H10.6666V24C10.6666 24.3536 10.8071 24.6928 11.0571 24.9428C11.3072 25.1929 11.6463 25.3333 11.9999 25.3333H19.9999C20.3535 25.3333 20.6927 25.1929 20.9427 24.9428C21.1928 24.6928 21.3333 24.3536 21.3333 24V10.6667H13.3333ZM17.3333 8H14.6666V6.66667H17.3333V8ZM13.3333 12C13.6869 12 14.026 12.1405 14.2761 12.3905C14.5261 12.6406 14.6666 12.9797 14.6666 13.3333V22.6667C14.6666 23.0203 14.5261 23.3594 14.2761 23.6095C14.026 23.8595 13.6869 24 13.3333 24C12.9796 24 12.6405 23.8595 12.3904 23.6095C12.1404 23.3594 11.9999 23.0203 11.9999 22.6667V13.3333C11.9999 12.9797 12.1404 12.6406 12.3904 12.3905C12.6405 12.1405 12.9796 12 13.3333 12ZM18.6666 12C19.0202 12 19.3593 12.1405 19.6094 12.3905C19.8594 12.6406 19.9999 12.9797 19.9999 13.3333V22.6667C19.9999 23.0203 19.8594 23.3594 19.6094 23.6095C19.3593 23.8595 19.0202 24 18.6666 24C18.313 24 17.9738 23.8595 17.7238 23.6095C17.4737 23.3594 17.3333 23.0203 17.3333 22.6667V13.3333C17.3333 12.9797 17.4737 12.6406 17.7238 12.3905C17.9738 12.1405 18.313 12 18.6666 12ZM19.6999 8.3V6.66667C19.6999 6.03899 19.4506 5.43702 19.0067 4.99318C18.5629 4.54934 17.9609 4.3 17.3333 4.3H14.6666C14.0389 4.3 13.4369 4.54934 12.9931 4.99318C12.5493 5.43702 12.2999 6.03899 12.2999 6.66667V8.3H6.66659C6.39253 8.3 6.1297 8.40887 5.93591 8.60266C5.74212 8.79644 5.63325 9.05928 5.63325 9.33333C5.63325 9.60739 5.74212 9.87022 5.93591 10.064C6.1297 10.2578 6.39253 10.3667 6.66659 10.3667H8.29992V24C8.29992 24.9813 8.68974 25.9224 9.38362 26.6163C10.0775 27.3102 11.0186 27.7 11.9999 27.7H19.9999C20.9812 27.7 21.9223 27.3102 22.6162 26.6163C23.3101 25.9224 23.6999 24.9813 23.6999 24V10.3667H25.3333C25.6073 10.3667 25.8701 10.2578 26.0639 10.064C26.2577 9.87022 26.3666 9.60739 26.3666 9.33333C26.3666 9.05928 26.2577 8.79644 26.0639 8.60266C25.8701 8.40887 25.6073 8.3 25.3333 8.3H19.6999ZM10.3666 10.3667H21.6333V24C21.6333 24.4332 21.4612 24.8486 21.1549 25.1549C20.8485 25.4613 20.4331 25.6333 19.9999 25.6333H11.9999C11.5667 25.6333 11.1513 25.4613 10.845 25.1549C10.5387 24.8486 10.3666 24.4332 10.3666 24V10.3667ZM17.6333 8.3H14.3666V6.36667H17.6333V8.3ZM11.9999 8H6.66659C6.31296 8 5.97383 8.14048 5.72378 8.39052C5.47373 8.64057 5.33325 8.97971 5.33325 9.33333C5.33325 9.68696 5.47373 10.0261 5.72378 10.2761C5.97383 10.5262 6.31296 10.6667 6.66659 10.6667H7.99992V24C7.99992 25.0609 8.42135 26.0783 9.17149 26.8284C9.92164 27.5786 10.9391 28 11.9999 28H19.9999C21.0608 28 22.0782 27.5786 22.8283 26.8284C23.5785 26.0783 23.9999 25.0609 23.9999 24V10.6667H25.3333C25.6869 10.6667 26.026 10.5262 26.2761 10.2761C26.5261 10.0261 26.6666 9.68696 26.6666 9.33333C26.6666 8.97971 26.5261 8.64057 26.2761 8.39052C26.026 8.14048 25.6869 8 25.3333 8H19.9999V6.66667C19.9999 5.95942 19.719 5.28115 19.2189 4.78105C18.7188 4.28095 18.0405 4 17.3333 4H14.6666C13.9593 4 13.2811 4.28095 12.781 4.78105C12.2809 5.28115 11.9999 5.95942 11.9999 6.66667V8ZM10.6666 10.6667H21.3333V24C21.3333 24.3536 21.1928 24.6928 20.9427 24.9428C20.6927 25.1929 20.3535 25.3333 19.9999 25.3333H11.9999C11.6463 25.3333 11.3072 25.1929 11.0571 24.9428C10.8071 24.6928 10.6666 24.3536 10.6666 24V10.6667ZM14.0639 12.6027C13.8701 12.4089 13.6073 12.3 13.3333 12.3C13.0592 12.3 12.7964 12.4089 12.6026 12.6027C12.4088 12.7964 12.2999 13.0593 12.2999 13.3333V22.6667C12.2999 22.9407 12.4088 23.2036 12.6026 23.3973C12.7964 23.5911 13.0592 23.7 13.3333 23.7C13.6073 23.7 13.8701 23.5911 14.0639 23.3973C14.2577 23.2036 14.3666 22.9407 14.3666 22.6667V13.3333C14.3666 13.0593 14.2577 12.7964 14.0639 12.6027ZM19.3973 12.6027C19.2035 12.4089 18.9406 12.3 18.6666 12.3C18.3925 12.3 18.1297 12.4089 17.9359 12.6027C17.7421 12.7964 17.6333 13.0593 17.6333 13.3333V22.6667C17.6333 22.9407 17.7421 23.2036 17.9359 23.3973C18.1297 23.5911 18.3925 23.7 18.6666 23.7C18.9406 23.7 19.2035 23.5911 19.3973 23.3973C19.5911 23.2036 19.6999 22.9407 19.6999 22.6667V13.3333C19.6999 13.0593 19.5911 12.7964 19.3973 12.6027ZM17.3333 8V6.66667H14.6666V8H17.3333ZM14.2761 12.3905C14.026 12.1405 13.6869 12 13.3333 12C12.9796 12 12.6405 12.1405 12.3904 12.3905C12.1404 12.6406 11.9999 12.9797 11.9999 13.3333V22.6667C11.9999 23.0203 12.1404 23.3594 12.3904 23.6095C12.6405 23.8595 12.9796 24 13.3333 24C13.6869 24 14.026 23.8595 14.2761 23.6095C14.5261 23.3594 14.6666 23.0203 14.6666 22.6667V13.3333C14.6666 12.9797 14.5261 12.6406 14.2761 12.3905ZM19.6094 12.3905C19.3593 12.1405 19.0202 12 18.6666 12C18.313 12 17.9738 12.1405 17.7238 12.3905C17.4737 12.6406 17.3333 12.9797 17.3333 13.3333V22.6667C17.3333 23.0203 17.4737 23.3594 17.7238 23.6095C17.9738 23.8595 18.313 24 18.6666 24C19.0202 24 19.3593 23.8595 19.6094 23.6095C19.8594 23.3594 19.9999 23.0203 19.9999 22.6667V13.3333C19.9999 12.9797 19.8594 12.6406 19.6094 12.3905Z" fill="currentColor"/>
            </svg>
          </div>
         </div>
        </div>
    </section>
  </template>
</template>

<script>
import {computed} from 'vue'
import {useStore} from 'vuex'
import {useRouter} from 'vue-router'
import AppStatus from '@/components/AppStatus/AppStatus.vue'

export default {
  name: 'Home',
  setup() {
    const store = useStore()
    const router = useRouter()

    const deleteTask = (id)  => {
      store.dispatch('deleteTask', id)
    }
    const tasks = computed(() => store.getters.tasks)
    const activeTasksCount = computed(() => store.getters.activeTasksCount)

    return {
      tasks, 
      activeTasksCount,
      open: id => router.push(`/task/${id}`),
      deleteTask,
    }
  },
  components: {AppStatus}
}
</script>